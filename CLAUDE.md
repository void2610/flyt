# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**Flyt** ã¯ã€ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ—ãƒªã®ä¸Šã«ã‚‚è¡¨ç¤ºã§ãã‚‹macOSç”¨ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ã‚¢ãƒ—ãƒªã§ã™ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼ˆControl+Iï¼‰ã§ã©ã“ã‹ã‚‰ã§ã‚‚å‘¼ã³å‡ºã—å¯èƒ½ãªã€ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¿ã‚¤ãƒãƒ¼ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’æä¾›ã—ã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

- **ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼**: ä½œæ¥­æ™‚é–“ã¨ä¼‘æ†©æ™‚é–“ã‚’ç®¡ç†
  - ä½œæ¥­æ™‚é–“ã¨ä¼‘æ†©æ™‚é–“ã¯è¨­å®šã‹ã‚‰å¤‰æ›´å¯èƒ½ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: ä½œæ¥­30åˆ†ã€ä¼‘æ†©10åˆ†ï¼‰
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ™‚ã«è‡ªå‹•ã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤º
  - æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯æ‰‹å‹•ã§é–‹å§‹ï¼ˆè‡ªå‹•é–‹å§‹ã—ãªã„ï¼‰
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚«ã‚¦ãƒ³ãƒˆ**: 1æ—¥ã®å®Œäº†ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ã‚’è¨˜éŒ²
  - æ¯æ—¥0æ™‚ã«è‡ªå‹•ãƒªã‚»ãƒƒãƒˆ
  - è¨­å®šç”»é¢ã‹ã‚‰æ‰‹å‹•ãƒªã‚»ãƒƒãƒˆã‚‚å¯èƒ½
- **ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³å¯¾å¿œ**: å…¨ã¦ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸Šã«è¡¨ç¤ºå¯èƒ½

## ãƒ“ãƒ«ãƒ‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã—ã¦ /Applications ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
bash build-and-install.sh

# ã¾ãŸã¯æ‰‹å‹•ãƒ“ãƒ«ãƒ‰
xcodebuild -project Flyt.xcodeproj -scheme Flyt -configuration Release build
```

**é‡è¦**:
- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ¨©é™ã®æ°¸ç¶šåŒ–ã®ãŸã‚ã€`build-and-install.sh` ã‚’ä½¿ç”¨ã—ã¦ `/Applications` ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨
- DerivedData ã‹ã‚‰ã®å®Ÿè¡Œã§ã¯ã€ãƒ“ãƒ«ãƒ‰ã”ã¨ã«ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ¨©é™ã®å†ä»˜ä¸ãŒå¿…è¦ã«ãªã‚‹

## é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**é‡è¦**: ã‚³ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.swiftï¼‰ã‚’ç·¨é›†ã—ãŸå¾Œã¯ã€å¿…ãš `bash build-and-install.sh` ã‚’å®Ÿè¡Œã—ã¦ãƒ“ãƒ«ãƒ‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³å¯¾å¿œã®å®Ÿè£…

SwiftUI ã®æ¨™æº– Window ã‚·ãƒ¼ãƒ³ã§ã¯ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ—ãƒªã®ä¸Šã«è¡¨ç¤ºã§ããªã„ãŸã‚ã€ä»¥ä¸‹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ¡ç”¨ï¼š

1. **WindowManager.swift**: `NSWindow` ã‚’æ‰‹å‹•ä½œæˆ
   - `window.level = NSWindow.Level(rawValue: Int(CGShieldingWindowLevel()))` ã§ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ä»¥ä¸Šã®è¡¨ç¤ºãƒ¬ãƒ™ãƒ«ã‚’è¨­å®š
   - `window.collectionBehavior = [.canJoinAllSpaces, .transient, .fullScreenAuxiliary]` ã§å…¨ã‚¹ãƒšãƒ¼ã‚¹å¯¾å¿œ
   - `NSHostingView` ã§ SwiftUI ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ©ãƒƒãƒ—
   - ã‚¿ã‚¤ãƒãƒ¼ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼ˆ600x350ï¼‰ã¨è¨­å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸¡æ–¹ã‚’ç®¡ç†ï¼ˆè¨­å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¯é€šå¸¸ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ¬ãƒ™ãƒ«ï¼‰
   - `showWindow()` ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ™‚ã«è‡ªå‹•è¡¨ç¤º

2. **AppDelegate.swift**: ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç›£è¦–
   - ãƒ­ãƒ¼ã‚«ãƒ« (`NSEvent.addLocalMonitorForEvents`) ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ« (`NSEvent.addGlobalMonitorForEvents`) ã®ä¸¡æ–¹ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚’ä½¿ç”¨
   - HotKeyManager ã¨é€£æºã—ã¦ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã®ä¸€è‡´ã‚’åˆ¤å®š
   - ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ¨©é™ãŒå¿…è¦ï¼ˆåˆå›èµ·å‹•æ™‚ã«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºï¼‰
   - Timer ã«ã‚ˆã‚‹æ¨©é™ä»˜ä¸ã®è‡ªå‹•æ¤œå‡ºã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ¢ãƒ‹ã‚¿ãƒ¼ã®å†ç™»éŒ²

3. **FlytApp.swift**: ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
   - `NSApp.setActivationPolicy(.accessory)` ã§ Dock ã‚¢ã‚¤ã‚³ãƒ³ã‚’éè¡¨ç¤º
   - AppDelegate ã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’åˆæœŸåŒ–

### ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç®¡ç†

- **HotKeyManager.swift**: ãƒ›ãƒƒãƒˆã‚­ãƒ¼è¨­å®šã®ç®¡ç†ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰
  - UserDefaults ã§ãƒ¢ãƒ‡ã‚£ãƒ•ã‚¡ã‚¤ã‚¢ã‚­ãƒ¼ (modifierFlags) ã¨ã‚­ãƒ¼ã‚³ãƒ¼ãƒ‰ (keyCode) ã‚’æ°¸ç¶šåŒ–
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ Control+I (keyCode 34)
  - `matches(event:)` ã§ã‚¤ãƒ™ãƒ³ãƒˆã¨ã®ä¸€è‡´ã‚’åˆ¤å®š
  - `getHotKeyString()` ã§ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã®è¡¨ç¤ºç”¨æ–‡å­—åˆ—ã‚’ç”Ÿæˆï¼ˆâŒƒI ãªã©ï¼‰

### ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼

- **MenuBarManager.swift**: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ã¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ç®¡ç†ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰
  - SF Symbols ã® "text.book.closed" ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨
  - HotKeyManager ã®å¤‰æ›´ã‚’ Combine ã§ç›£è¦–ã—ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è‡ªå‹•æ›´æ–°
  - ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®: ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤º/éè¡¨ç¤ºã€è¨­å®šã€çµ‚äº†
  - ç¾åœ¨ã®ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã‚’ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«è¡¨ç¤º

### ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ç®¡ç†

- **PomodoroManager.swift**: ã‚¿ã‚¤ãƒãƒ¼ã®ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰
  - ä½œæ¥­æ™‚é–“ã¨ä¼‘æ†©æ™‚é–“ã®ç®¡ç†ï¼ˆUserDefaults ã§æ°¸ç¶šåŒ–ï¼‰
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ã®ã‚«ã‚¦ãƒ³ãƒˆã¨ä¿å­˜
  - æ¯æ—¥0æ™‚ã®è‡ªå‹•ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ï¼ˆTimer ã‚’ä½¿ç”¨ï¼‰
  - ã‚¿ã‚¤ãƒãƒ¼ã®é–‹å§‹/ä¸€æ™‚åœæ­¢/ãƒªã‚»ãƒƒãƒˆ/ã‚¹ã‚­ãƒƒãƒ—æ©Ÿèƒ½
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº†æ™‚ã«è‡ªå‹•ã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤º
  - æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯è‡ªå‹•é–‹å§‹ã›ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œã‚’å¾…ã¤

### ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

- UserDefaults ã‚’ä½¿ç”¨
  - `workDurationMinutes`: ä½œæ¥­æ™‚é–“ï¼ˆåˆ†ï¼‰
  - `restDurationMinutes`: ä¼‘æ†©æ™‚é–“ï¼ˆåˆ†ï¼‰
  - `sessionCount`: å®Œäº†ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°
  - `lastResetDate`: æœ€å¾Œã«ãƒªã‚»ãƒƒãƒˆã—ãŸæ—¥ä»˜ï¼ˆyyyy-MM-ddå½¢å¼ï¼‰

### UIæ§‹é€ 

- **ContentView.swift**: ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ç”»é¢ã®ãƒ©ãƒƒãƒ‘ãƒ¼
  - PomodoroTimerView ã‚’è¡¨ç¤º
  - Escã‚­ãƒ¼ã§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ã‚‹
- **PomodoroTimerView.swift**: ãƒ¡ã‚¤ãƒ³ã®ã‚¿ã‚¤ãƒãƒ¼UI
  - ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤ºï¼ˆ100ptã®ãƒ¢ãƒã‚¹ãƒšãƒ¼ã‚¹ãƒ•ã‚©ãƒ³ãƒˆï¼‰
  - 3ã¤ã®å††å½¢ãƒœã‚¿ãƒ³: ãƒªã‚»ãƒƒãƒˆã€é–‹å§‹/ä¸€æ™‚åœæ­¢ã€ã‚¹ã‚­ãƒƒãƒ—
  - çŠ¶æ…‹è¡¨ç¤º: æº–å‚™å®Œäº†ğŸ…ä½œæ¥­ä¸­â˜•ï¸ä¼‘æ†©ä¸­
  - å®Œäº†ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ã®è¡¨ç¤º
  - ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚º: 600x350
- **SettingsView.swift**: è¨­å®šç”»é¢ï¼ˆã‚¿ãƒ–å½¢å¼ï¼‰
  - **GeneralSettingsTab**: ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­è¨­å®š
    - ä½œæ¥­æ™‚é–“ã¨ä¼‘æ†©æ™‚é–“ã®è¨­å®šï¼ˆTextFieldã§ç›´æ¥å…¥åŠ›ï¼‰
    - ã‚»ãƒƒã‚·ãƒ§ãƒ³æ•°ã®è¡¨ç¤ºã¨æ‰‹å‹•ãƒªã‚»ãƒƒãƒˆ
    - ã‚¿ã‚¤ãƒãƒ¼ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³
    - ã‚¢ãƒ—ãƒªçµ‚äº†ãƒœã‚¿ãƒ³
  - **HotKeySettingsTab**: ãƒ›ãƒƒãƒˆã‚­ãƒ¼è¨­å®š
    - HotKeyRecorderView ã§ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
  - **AccessibilitySettingsTab**: ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ¨©é™è¨­å®š
    - æ¨©é™çŠ¶æ…‹ã®ç¢ºèªã¨ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã¸ã®ãƒªãƒ³ã‚¯
  - **AboutTab**: ã‚¢ãƒ—ãƒªæƒ…å ±
    - ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¨é–‹ç™ºè€…æƒ…å ±

## æ³¨æ„äº‹é …

- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ¨©é™: ã‚·ã‚¹ãƒ†ãƒ è¨­å®š > ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ > ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ ã§ã‚¢ãƒ—ãƒªã‚’è¨±å¯
- ãƒ›ãƒƒãƒˆã‚­ãƒ¼ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¨­å®šå¯èƒ½ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ Control+Iã€keyCode 34ï¼‰
- Product Name: "Flyt", Bundle ID: "void2610.Flyt"
- ä¸»è¦ãªãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚¯ãƒ©ã‚¹ã¯ã™ã¹ã¦ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ (WindowManager, HotKeyManager, MenuBarManager, PomodoroManager, AppState)

## ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ

```
Flyt/
â”œâ”€â”€ App/
â”‚   â”œâ”€â”€ FlytApp.swift          # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ AppDelegate.swift      # ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ›ãƒƒãƒˆã‚­ãƒ¼ç›£è¦–
â”‚   â””â”€â”€ AppState.swift         # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†
â”œâ”€â”€ Managers/
â”‚   â”œâ”€â”€ WindowManager.swift    # ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç®¡ç†ï¼ˆã‚¿ã‚¤ãƒãƒ¼ã¨è¨­å®šï¼‰
â”‚   â”œâ”€â”€ HotKeyManager.swift    # ãƒ›ãƒƒãƒˆã‚­ãƒ¼è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ MenuBarManager.swift   # ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ç®¡ç†
â”‚   â””â”€â”€ PomodoroManager.swift  # ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ ContentView.swift      # ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ¥ãƒ¼ã®ãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â””â”€â”€ PomodoroTimerView.swift # ã‚¿ã‚¤ãƒãƒ¼UI
â”œâ”€â”€ Settings/
â”‚   â”œâ”€â”€ SettingsView.swift           # è¨­å®šç”»é¢ã®ãƒ¡ã‚¤ãƒ³ãƒ“ãƒ¥ãƒ¼
â”‚   â”œâ”€â”€ GeneralSettingsTab.swift     # ä¸€èˆ¬è¨­å®šã‚¿ãƒ–
â”‚   â”œâ”€â”€ HotKeySettingsTab.swift      # ãƒ›ãƒƒãƒˆã‚­ãƒ¼è¨­å®šã‚¿ãƒ–
â”‚   â”œâ”€â”€ AccessibilitySettingsTab.swift # ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£è¨­å®šã‚¿ãƒ–
â”‚   â””â”€â”€ AboutTab.swift               # ã‚¢ãƒ—ãƒªæƒ…å ±ã‚¿ãƒ–
â””â”€â”€ Components/
    â””â”€â”€ HotKeyRecorderView.swift     # ãƒ›ãƒƒãƒˆã‚­ãƒ¼è¨˜éŒ²ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```
